DATA:
    TRAIN_PATH: '/Data/Dataset/Waymo/V1_2_tf/training_extracted'
    VAL_PATH: '/Data/Dataset/Waymo/V1_2_tf/validation_extracted'

MODEL:
    CONTEXT_ENCODER:
        NAME: MTREncoder

        NUM_OF_ATTN_NEIGHBORS: 16
        NUM_INPUT_ATTR_AGENT: 29
        NUM_INPUT_ATTR_MAP: 9
        
        NUM_CHANNEL_IN_MLP_AGENT: 256
        NUM_CHANNEL_IN_MLP_MAP: 64
        NUM_LAYER_IN_MLP_AGENT: 3
        NUM_LAYER_IN_MLP_MAP: 5
        NUM_LAYER_IN_PRE_MLP_MAP: 3

        D_MODEL: 256
        NUM_ATTN_LAYERS: 6
        NUM_ATTN_HEAD: 8 
        DROPOUT_OF_ATTN: 0.1 

        USE_LOCAL_ATTN: True

    MOTION_DECODER:
        NAME: BCDecoder
        TYPE: discrete
        PRED_ALL_LAYERS: False

        HIERARCHICAL_LEVELS: 3 # gird size 4, 8, 16
        HIERARCHICAL_WEIGHT: [0.6, 0.8, 1]
        MAX_ACCEL: 8.0
        MAX_STEER: 0.8

        ENTROPY_WEIGHT: 1
        
        D_MODEL: 256
        NUM_DECODER_LAYERS: 4
        NUM_ATTN_HEAD: 8
        MAP_D_MODEL: 256
        DROPOUT_OF_ATTN: 0.1 

        NUM_BASE_MAP_POLYLINES: 256
        NUM_WAYPOINT_MAP_POLYLINES: 128


OPTIMIZATION:
    BATCH_SIZE_PER_GPU: 32
    MAX_STEPS: 500_000
    VAL_CHECK_INTERVAL: 5_000
    LIMIT_VAL_BATCHES: 500

    LR: 0.0001
    WEIGHT_DECAY: 0.01

    LR_WARMUP: 10_000
    LR_GAMMA: 0.9
    LR_STEP: 50_000
